#!/usr/bin/env node
import { createRequire } from 'module';
const require = createRequire(import.meta.url)
const concat = require('concat-stream')
const fs = require('fs')
import ssc from './index.js'
var createHash = require('create-hash')

const argv = require('minimist')(process.argv.slice(2))

const commands = {
    // print keys to stdout
    // _example:_
    // ./cli.js keys 
    keys: function () {
        ssc.createKeys().then(myKeys => {
            ssc.exportKeys(myKeys.keys).then(exported => {
                exported.did = myKeys.did
                exported.id = myKeys.id
                process.stdout.write(JSON.stringify(exported, null, 2) + '\n')
            })
        })
    },


    // input includes JSON keys piped into stdin
    // also requires a `--text` option in the CLI
    // _example:_
    // ./cli.js keys | ./cli.js post --text "woooo more test"

    // pass in a previous message to create a merkle-list
    // ./cli.js keys | ./cli.js post --text "woooo testing again" --prev="$(cat ./test/cli/message-json.json)"

    // or omit `--prev` to create a message with `null` as previous
    post: function () {
        const sink = concat({ encoding: 'string' }, keys => {
            var prev = argv.prev || null
            const ks = JSON.parse(keys)
            prev = JSON.parse(prev)

            ssc.importKeys({ keys: ks }).then(imported => {
                ssc.createMsg(imported, prev, {
                    type: 'post',
                    text: argv.text || argv.t
                }).then(msg => {
                    process.stdout.write(JSON.stringify(msg, null, 2) + '\n')
                })
            })
        })

        if (!argv.text && !argv.t) {
            return process.stdout.write(usage())
        }

        process.stdin.pipe(sink)
    },

    // _example_
    // cat test/cli/message-json.json | ./cli.js id
    id: function () {
        const sink = concat({ encoding: 'string' }, json => {
            const parsed = JSON.parse(json)
            process.stdout.write(ssc.getId(parsed) + '\n')
        })

        process.stdin.pipe(sink)
    },

    hash: function () {
        var hash = createHash('sha256')
        // process.stdin.pipe(hash)

        const filename = argv._[1]

        const base64 = "data:image/jpeg;base64," +
            fs.readFileSync(filename, 'base64')
        
        // console.log('base64', base64)

        const base64Str =
            'data:image/jpeg;base64,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'

        console.log('eq', base64 === base64Str)

        var hash = createHash('sha256')
        // hash.update(base64Str)
        hash.update(base64)
        const _hash = hash.digest('base64') 

        console.log('hashhhhhh', _hash)

        // hash.on('finish', ev => {
        //     // hash.end()
        //     // console.log('read', hash.read().toString('base64'))
        //     console.log('read', hash.read().toString('base64'))
        //     // hash.read().pipe(process.stdout)
        //     // console.log('read', hash.read().toString())
        // })
    }
}

const cmd = argv._[0]

if (commands[cmd]) {
    commands[cmd]()
} else {
    process.stdout.write(usage())
}

function usage () {
    return `
        Usage instruction go here
    `
}
